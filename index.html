<canvas id="ctx" width="600" height="600" style="border:1px solid #000000"></canvas>
<script src="/socket.io/socket.io.js"></script>
<script>
  var socket = io();
  var ctx = document.getElementById("ctx").getContext("2d");
  //scale canvas to match coordinates
  //var canvasWidth = window.innerWidth;
  //var canvasHeight = window.innerHeight;
  //var imageWidth = 600;
  //var imageHeight = 600;
  //var aspectRatioW = canvasWidth/imageWidth;
  //var aspectRatioH = canvasHeight/imageHeight;
  //ctx.scale(aspectRatioW, aspectRatioH);
  console.log(ctx.clientWidth);

  var letters = [];

  function Letter(char, x, y, randomRotation)
  {
    this.char = char;
    this.x = x;
    this.y = y;
    this.rotation = randomRotation;
    this.size = 8;
    this.display = display;
    this.color = "rgb(100,200,30)";

    function display()
    {
      ctx.save();
      ctx.translate(this.x, this.y);
      //ctx.rotate(this.rotation);
      ctx.fillStyle = this.color;
      ctx.fillRect(this.x, this.y, this.size, this.size);
      ctx.restore();
    }
  }

  function init(){
    socket.on('existingSituation', loadExistingSituation);
    var numberOfLetters = 0;
    function loadExistingSituation(allLetters)
    {
        for(i in allLetters)
        {
          letters[i] = new Letter(
            allLetters[i].char,
            allLetters[i].x, allLetters[i].y,
            (Math.random()-0.5)*(Math.PI/32)
          );
          numberOfLetters++;
        }
        console.log(numberOfLetters + " letters loaded");
    }
    window.requestAnimationFrame(draw);
  }

  function draw(){
    ctx.clearRect(0,0,600,600);

    for(var i = 0; i < letters.length; i++)
    {
      letters[i].display();
    }

    window.requestAnimationFrame(draw);
  }

  init();

</script>
